<dom-module id="my-main">
  <style>
    :host {
      display: block;
    }

  </style>
  <template>

    <template is="dom-if" if="{{!user.isAuthenticated}}">
      <my-login></my-login>
    </template>

    <template is="dom-if" if="{{user.isAuthenticated}}">
      <form id="formLogout" is="iron-form" action="/security/deauthentication" method="post">
        <paper-button raised on-tap="doLogout">Sair</paper-button>
      </form>
    </template>

  </template>

  <script>
    (function() {
      'use strict';

      Polymer({

        is: 'my-main',

        properties: {
          user: {
            type: Object
          }
        },

        ready: function() {
          if (window.user != null && window.user.isAuthenticated) {
            this.set('user', window.user);
          } else {
            this.set('user', false);
          }

          if (window.globalMessage != null) {
            let app = document.querySelector('#app');
            app.$.toast.text = window.globalMessage;
            app.$.toast.show();
          }
        },

        doLogout: function() {
          document.getElementById('formLogout').submit();
        }

      });
    })();
  </script>
</dom-module>
